CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",lang:"en",icons:"bgcolor,textcolor",hidpi:true,init:function(d){var b=d.config,f=d.lang.colorbutton;if(!CKEDITOR.env.hc){c("TextColor","fore",f.textColorTitle,10);c("BGColor","back",f.bgColorTitle,20)}function c(i,k,l,g){var j=new CKEDITOR.style(b["colorButton_"+k+"Style"]),h=CKEDITOR.tools.getNextId()+"_colorBox";d.ui.add(i,CKEDITOR.UI_PANELBUTTON,{label:l,title:l,modes:{wysiwyg:1},editorFocus:0,toolbar:"colors,"+g,allowedContent:j,requiredContent:j,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":f.panelTitle}},onBlock:function(m,p){p.autoSize=true;p.element.addClass("cke_colorblock");p.element.setHtml(a(m,k,h));p.element.getDocument().getBody().setStyle("overflow","hidden");CKEDITOR.ui.fire("ready",this);var n=p.keys;var o=d.lang.dir=="rtl";n[o?37:39]="next";n[40]="next";n[9]="next";n[o?39:37]="prev";n[38]="prev";n[CKEDITOR.SHIFT+9]="prev";n[32]="click"},refresh:function(){if(!d.activeFilter.check(j)){this.setState(CKEDITOR.TRISTATE_DISABLED)}},onOpen:function(){var n=d.getSelection(),p=n&&n.getStartElement(),o=d.elementPath(p),m;if(!o){return}p=o.block||o.blockLimit||d.document.getBody();do{m=p&&p.getComputedStyle(k=="back"?"background-color":"color")||"transparent"}while(k=="back"&&m=="transparent"&&p&&(p=p.getParent()));if(!m||m=="transparent"){m="#ffffff"}this._.panel._.iframe.getFrameDocument().getById(h).setStyle("background-color",m);return m}})}function a(j,q,l){var m=[],k=b.colorButton_colors.split(","),n=d.plugins.colordialog&&b.colorButton_enableMore!==false,r=k.length+(n?2:1);var h=CKEDITOR.tools.addFunction(function(u,w){var x=arguments.callee;function v(y){this.removeListener("ok",v);this.removeListener("cancel",v);y.name=="ok"&&x(this.getContentElement("picker","selectedColor").getValue(),w)}if(u=="?"){d.openDialog("colordialog",function(){this.on("ok",v);this.on("cancel",v)});return}d.focus();j.hide();d.fire("saveSnapshot");d.removeStyle(new CKEDITOR.style(b["colorButton_"+w+"Style"],{color:"inherit"}));if(u){var i=b["colorButton_"+w+"Style"];i.childRule=w=="back"?function(y){return e(y)}:function(y){return !(y.is("a")||y.getElementsByTag("a").count())||e(y)};d.applyStyle(new CKEDITOR.style(i,{color:u}))}d.fire("saveSnapshot")});m.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',f.auto,'" onclick="CKEDITOR.tools.callFunction(',h,",null,'",q,"');return false;\" href=\"javascript:void('",f.auto,'\')" role="option" aria-posinset="1" aria-setsize="',r,'"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" id="',l,'"></span></td><td colspan=7 align=center>',f.auto,'</td></tr></table></a><table role="presentation" cellspacing=0 cellpadding=0 width="100%">');for(var p=0;p<k.length;p++){if((p%8)===0){m.push("</tr><tr>")}var o=k[p].split("/"),s=o[0],t=o[1]||s;if(!o[1]){s="#"+s.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3")}var g=d.lang.colorbutton.colors[t]||t;m.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',g,'" onclick="CKEDITOR.tools.callFunction(',h,",'",s,"','",q,"'); return false;\" href=\"javascript:void('",g,'\')" role="option" aria-posinset="',(p+2),'" aria-setsize="',r,'"><span class="cke_colorbox" style="background-color:#',t,'"></span></a></td>')}if(n){m.push('</tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',f.more,'" onclick="CKEDITOR.tools.callFunction(',h,",'?','",q,"');return false;\" href=\"javascript:void('",f.more,"')\"",' role="option" aria-posinset="',r,'" aria-setsize="',r,'">',f.more,"</a></td>")}m.push("</tr></table>");return m.join("")}function e(g){return(g.getAttribute("contentEditable")=="false")||g.getAttribute("data-nostyle")}}});CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF";CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};