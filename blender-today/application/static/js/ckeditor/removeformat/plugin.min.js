CKEDITOR.plugins.add("removeformat",{lang:"en",icons:"removeformat",hidpi:true,init:function(a){a.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat);a.ui.addButton&&a.ui.addButton("RemoveFormat",{label:a.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}});CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(l){var k=l._.removeFormatRegex||(l._.removeFormatRegex=new RegExp("^(?:"+l.config.removeFormatTags.replace(/,/g,"|")+")$","i"));var o=l._.removeAttributes||(l._.removeAttributes=l.config.removeFormatAttributes.split(",")),d=CKEDITOR.plugins.removeformat.filter,b=l.getSelection().getRanges(),h=b.createIterator(),n=function(p){return p.type==CKEDITOR.NODE_ELEMENT},i;while((i=h.getNextRange())){if(!i.collapsed){i.enlarge(CKEDITOR.ENLARGE_ELEMENT)}var m=i.createBookmark(),e=m.startNode,j=m.endNode,c;var g=function(s){var t=l.elementPath(s),p=t.elements;for(var q=1,r;r=p[q];q++){if(r.equals(t.block)||r.equals(t.blockLimit)){break}if(k.test(r.getName())&&d(l,r)){s.breakParent(r)}}};g(e);if(j){g(j);c=e.getNextSourceNode(true,CKEDITOR.NODE_ELEMENT);while(c){if(c.equals(j)){break}if(c.isReadOnly()){if(c.getPosition(j)&CKEDITOR.POSITION_CONTAINS){break}c=c.getNext(n);continue}var f=c.getNextSourceNode(false,CKEDITOR.NODE_ELEMENT),a=c.getName()=="img"&&c.data("cke-realelement");if(!a&&d(l,c)){if(k.test(c.getName())){c.remove(1)}else{c.removeAttributes(o);l.fire("removeFormatCleanup",c)}}c=f}}i.moveToBookmark(m)}l.forceNextSelectionCheck();l.getSelection().selectRanges(b)}}},filter:function(c,b){var d=c._.removeFormatFilters||[];for(var a=0;a<d.length;a++){if(d[a](b)===false){return false}}return true}};CKEDITOR.editor.prototype.addRemoveFormatFilter=function(a){if(!this._.removeFormatFilters){this._.removeFormatFilters=[]}this._.removeFormatFilters.push(a)};CKEDITOR.config.removeFormatTags="b,big,cite,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var";CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign";