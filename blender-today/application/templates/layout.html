<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block page_title %}Home{% endblock %} - Blender Today - Community-driven Blender News</title>
    <meta name="keywords" content="news, community, blender, animation, 3d" />
    <meta name="description" content="Community-driven Blender News"/>
    <meta name="author" content="Blender Today"/>
    <meta name="csrf-token" content="{{ csrf_token() }}">

    {% if config.USE_ASSETS_CDN %}
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
    {% else %}
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/font-awesome.min.css') }}" rel="stylesheet">
    {% endif %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

    <!-- IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="shortcut icon" href="{{ url_for('static', filename='ico/favicon.ico') }}">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="apple-touch-icon-57-precomposed.png">
    {% block header %}
    {% endblock %}
  </head>

  <body>
    {% block modal %}
    {% endblock %}
    <a name="hop"></a>

    {% for message in get_flashed_messages() %}
    <div class="alert alert-warning">
      <div class="container">
        {{ message }}
        <button type="button" class="close" data-dismiss="alert"><i class="fa fa-times"></i></button>
      </div>
    </div>
    {% endfor %}

    <div class="container">
      <div class="row">
        <div class="col-md-12">
          {% block body %}{% endblock %}
        </div>
      </div>
    </div> <!-- /container -->

    <footer>
      <div class="container">
        <span class="pull-left">
          <p class="text-center">
            Made with <i class="fa fa-heart-o"></i> in Amsterdam
          </p>
        </span>
        <span class="pull-right">
          <p>
            <a href="http://twitter.com/BlenderToday"
               title="Follow *yourself* on Twitter @BlenderToday">@BlenderToday</a>
            <span class="separator"></span>
            <a href="#hop"><i class="fa fa-angle-up"></i></a>
          </p>
        </span>
      </div> <!-- /footer-container -->

      <div id="submit" class="dialog">
        <div class="dialog__overlay"></div>
          <div class="dialog__content">
            {% include 'posts/form.html' %}
            <button class="action" data-dialog-close>
              <i class="fa fa-times"></i>
            </button>
        </div>
      </div>

    </footer>
    {% if config.USE_ASSETS_CDN %}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

    {% else %}
    <script src="{{url_for('static', filename='js/jquery.min.js')}}"></script>
    <script src="{{url_for('static', filename='js/bootstrap.min.js')}}"></script>
    {% endif %}

    <script type="text/javascript">
      $('.nav-logout-widget').click(function(e){
        e.preventDefault();

        $('.nav-logout-widget-question').animate({'opacity': 1.0, 'left' : 22}, 300);
        $('.nav-logout-widget-icon').css('color', 'crimson');
        $('.nav-logout-widget-icon').animate({'left' : 5}, 250, function(){
          $('.nav-logout-widget').unbind();
          $('.nav-logout-widget').attr('href', '{{url_for("logout")}}');
        });
      });
    </script>

    <script src="{{url_for('static', filename='js/dialogFx.js')}}"></script>
    <script src="{{url_for('static', filename='js/classie.js')}}"></script>
    <script src="//cdn.ckeditor.com/4.4.7/basic/ckeditor.js"></script>
    <script type="text/javascript">


      {% if current_user.is_anonymous() %}
        $('.popover-submit').popover();
      {% else %}
        var csrftoken = $('meta[name=csrf-token]').attr('content');

        $.ajaxSetup({
          beforeSend: function(xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
              xhr.setRequestHeader("X-CSRFToken", csrftoken)
            }
          }
        });

        $("form").on("submit", function (event) {
            event.preventDefault();
            //$('#edit_notifications').html('<i>Updating</i>');
            var data = $(this).serialize();
            url = $(this).attr('action');
            var formData = new FormData($(this)[0]);
            $.ajax( {
                  url: url,
                  type: 'POST',
                  data: formData,
                  processData: false,
                  contentType: false,
                  cache: false
                } )
            .done(function() {
                //window.location = data['post_url'];
            })
            .fail(function() {
                //$('#edit_notifications').html('Error: could not update asset');
            });
        });

        (function() {
          var dlgtrigger = document.querySelector( '[data-dialog]' ),
            somedialog = document.getElementById( dlgtrigger.getAttribute( 'data-dialog' ) ),
            dlg = new DialogFx( somedialog );
          dlgtrigger.addEventListener( 'click', dlg.toggle.bind(dlg) );
        })();

        CKEDITOR.replace( 'post_content', {
          removePlugins: 'elementspath',
          resize_enabled: false
        });

        CKEDITOR.config.forcePasteAsPlainText = true;
        $('.select-change').click(function(){ 
            $('#post_type_id').val($(this).data('val')).trigger('change');
        })

        $('.select-change').click(function(){ 
          $('.post-submit-div-title').show();
          $('.post-submit-div-category').show();
          $('.post-submit-div-picture').show();
          $('.post-submit-div-submit').show();

          if ($('#post_type_id').val() == 1){
            $('.post-submit-link').show();
            $('.post-submit-article').hide();
          };
          if ($('#post_type_id').val() == 2){
            $('.post-submit-link').hide();
            $('.post-submit-article').show();
          };
        });

      {% endif %}

    </script>

  {% block footer_scripts %}
  {% endblock %}



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', '{{config.GOOGLE_ANALYTICS_TRACKING_ID}}', 'auto');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>
  </body>
</html>

